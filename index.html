<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>The Name Universe 2.0</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&display=swap');
    body {
      margin: 0;
      height: 100vh;
      background: radial-gradient(ellipse at bottom, #0a0f23 0%, #000000 100%);
      overflow: hidden;
      font-family: 'Orbitron', sans-serif;
      color: #fff;
    }

    /* Background stars */
    canvas#bg {
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      z-index: -1;
    }

    /* Bubbles */
    .bubble {
      position: absolute;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, #0ff, #004);
      box-shadow: 0 0 20px #0ff, 0 0 40px #00f inset;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: grab;
      transition: transform 0.2s ease;
      touch-action: none; /* allow drag on mobile */
    }
    .bubble:active {
      cursor: grabbing;
    }

    /* Ripple click effect */
    .bubble::after {
      content: "";
      position: absolute;
      border-radius: 50%;
      width: 100%; height: 100%;
      top: 0; left: 0;
      box-shadow: 0 0 30px rgba(0,255,255,0.6);
      opacity: 0;
      transition: opacity 0.3s, transform 0.3s;
    }
    .bubble.clicked::after {
      opacity: 1;
      transform: scale(1.5);
    }

    /* Input popup */
    #popup {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(0,0,0,0.85);
      z-index: 10;
    }
    #popup-box {
      background: rgba(20, 20, 40, 0.9);
      border: 2px solid #0ff;
      padding: 30px;
      border-radius: 20px;
      box-shadow: 0 0 30px #0ff;
      text-align: center;
      max-width: 300px;
      width: 90%;
    }
    #popup-box h2 {
      color: #0ff;
      margin-bottom: 15px;
    }
    #nameInput {
      padding: 12px;
      font-size: 16px;
      border-radius: 10px;
      border: none;
      outline: none;
      text-align: center;
      width: 100%;
      margin-bottom: 15px;
    }
    #submitBtn {
      padding: 10px 25px;
      font-size: 16px;
      background: #0ff;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      color: black;
      font-weight: bold;
      box-shadow: 0 0 15px #0ff;
    }
    #submitBtn:hover {
      background: #00aaff;
      box-shadow: 0 0 25px #00aaff;
    }

    /* Bubble name popup */
    #namePopup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0,0,30,0.95);
      border: 2px solid #0ff;
      padding: 20px 30px;
      border-radius: 20px;
      box-shadow: 0 0 30px #0ff;
      display: none;
      z-index: 20;
      color: #0ff;
      font-size: 20px;
      text-align: center;
      max-width: 300px;
    }
    #namePopup button {
      margin-top: 10px;
      background: #0ff;
      border: none;
      border-radius: 10px;
      padding: 8px 16px;
      cursor: pointer;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <!-- Background stars -->
  <canvas id="bg"></canvas>

  <!-- Input popup -->
  <div id="popup">
    <div id="popup-box">
      <h2>Enter Your Name âœ¨</h2>
      <input type="text" id="nameInput" placeholder="Your Name">
      <br>
      <button id="submitBtn">Shine</button>
    </div>
  </div>

  <!-- Bubble name popup -->
  <div id="namePopup">
    <div id="popupName"></div>
    <button id="editBtn">Edit</button>
    <button id="deleteBtn">Delete</button>
    <button id="closePopup">Close</button>
  </div>

  <script>
    const popup = document.getElementById("popup");
    const submitBtn = document.getElementById("submitBtn");
    const nameInput = document.getElementById("nameInput");
    const namePopup = document.getElementById("namePopup");
    const popupName = document.getElementById("popupName");
    const closePopup = document.getElementById("closePopup");
    const editBtn = document.getElementById("editBtn");
    const deleteBtn = document.getElementById("deleteBtn");

    let currentBubble = null;

    // Load saved bubbles
    window.onload = () => {
      let names = JSON.parse(localStorage.getItem("bubbles2")) || [];
      names.forEach(n => createBubble(n.text, n.x, n.y, n.size));
      starfield();
    };

    // Submit new bubble
    submitBtn.addEventListener("click", () => {
      const name = nameInput.value.trim();
      if(name) {
        createBubble(name);
        saveBubble({text:name});
        popup.style.display = "none";
      }
    });

    // Save bubbles
    function saveBubble(bubble){
      let bubbles = JSON.parse(localStorage.getItem("bubbles2")) || [];
      bubbles.push(bubble);
      localStorage.setItem("bubbles2", JSON.stringify(bubbles));
    }
    function updateStorage(){
      const bubbles = Array.from(document.querySelectorAll(".bubble")).map(b => ({
        text: b.dataset.name,
        x: b.style.left,
        y: b.style.top,
        size: b.style.width
      }));
      localStorage.setItem("bubbles2", JSON.stringify(bubbles));
    }

    // Create bubble
    function createBubble(name, x, y, size){
      const bubble = document.createElement("div");
      bubble.className = "bubble";
      bubble.dataset.name = name;

      let s = size || (Math.random()*50+50)+"px";
      bubble.style.width = s;
      bubble.style.height = s;
      bubble.style.left = x || Math.random()*(window.innerWidth-100)+"px";
      bubble.style.top = y || Math.random()*(window.innerHeight-100)+"px";

      // click -> open popup
      bubble.addEventListener("click", (e)=>{
        e.stopPropagation();
        currentBubble = bubble;
        popupName.textContent = bubble.dataset.name;
        bubble.classList.add("clicked");
        setTimeout(()=>bubble.classList.remove("clicked"),300);
        namePopup.style.display = "block";
      });

      enableDrag(bubble);
      document.body.appendChild(bubble);
    }

    // Dragging support
    function enableDrag(el){
      let offsetX, offsetY, dragging = false;

      function down(e){
        dragging = true;
        const rect = el.getBoundingClientRect();
        offsetX = (e.touches? e.touches[0].clientX : e.clientX) - rect.left;
        offsetY = (e.touches? e.touches[0].clientY : e.clientY) - rect.top;
      }
      function move(e){
        if(!dragging) return;
        const x = (e.touches? e.touches[0].clientX : e.clientX) - offsetX;
        const y = (e.touches? e.touches[0].clientY : e.clientY) - offsetY;
        el.style.left = x+"px";
        el.style.top = y+"px";
      }
      function up(){
        dragging = false;
        updateStorage();
      }

      el.addEventListener("mousedown", down);
      el.addEventListener("mousemove", move);
      el.addEventListener("mouseup", up);
      el.addEventListener("mouseleave", up);
      el.addEventListener("touchstart", down);
      el.addEventListener("touchmove", move);
      el.addEventListener("touchend", up);
    }

    // Popup buttons
    closePopup.addEventListener("click", ()=> namePopup.style.display="none");
    editBtn.addEventListener("click", ()=>{
      const newName = prompt("Edit name:", currentBubble.dataset.name);
      if(newName){
        currentBubble.dataset.name = newName;
        popupName.textContent = newName;
        updateStorage();
      }
    });
    deleteBtn.addEventListener("click", ()=>{
      currentBubble.remove();
      namePopup.style.display="none";
      updateStorage();
    });

    // Background stars + shooting stars
    function starfield(){
      const canvas = document.getElementById("bg");
      const ctx = canvas.getContext("2d");
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;

      const stars = [];
      for(let i=0;i<200;i++){
        stars.push({
          x: Math.random()*canvas.width,
          y: Math.random()*canvas.height,
          radius: Math.random()*1.5,
          speed: Math.random()*0.5
        });
      }
      const shootingStars = [];

      function animate(){
        ctx.clearRect(0,0,canvas.width,canvas.height);
        ctx.fillStyle = "white";
        stars.forEach(s=>{
          ctx.beginPath();
          ctx.arc(s.x,s.y,s.radius,0,Math.PI*2);
          ctx.fill();
          s.y+=s.speed;
          if(s.y>canvas.height) s.y=0;
        });

        // shooting star
        if(Math.random()<0.002){
          shootingStars.push({x:Math.random()*canvas.width,y:0,len:Math.random()*80+50});
        }
        ctx.strokeStyle="white";
        shootingStars.forEach((st,i)=>{
          ctx.beginPath();
          ctx.moveTo(st.x,st.y);
          ctx.lineTo(st.x-st.len,st.y+st.len/2);
          ctx.stroke();
          st.x+=5; st.y+=5;
          if(st.y>canvas.height) shootingStars.splice(i,1);
        });

        requestAnimationFrame(animate);
      }
      animate();
    }
  </script>
</body>
</html>
