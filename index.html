<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Kingdom Blockchain Mobile</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      font-family: Arial, sans-serif;
      background: linear-gradient(to bottom, #87ceeb, #fff);
    }
    canvas {
      display: block;
    }
    #loadingScreen, #menuScreen {
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      background: rgba(0,0,0,0.8);
      color: white;
      font-size: 2em;
      z-index: 10;
    }
    #menuScreen { display: none; }
    button {
      margin: 10px;
      padding: 15px 30px;
      font-size: 1em;
      border: none;
      border-radius: 8px;
      background: #4CAF50;
      color: white;
      cursor: pointer;
    }
    button:hover {
      background: #45a049;
    }
  </style>
</head>
<body>
  <div id="loadingScreen">Loading... 0%</div>
  <div id="menuScreen">
    <h1>Bucket Catch Game</h1>
    <button id="startButton">Start Game</button>
    <button id="missionsButton">Missions</button>
    <button id="achievementsButton">Achievements</button>
    <button id="marketplaceButton">Marketplace</button>
  </div>
  <canvas id="gameCanvas"></canvas>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    const loadingScreen = document.getElementById("loadingScreen");
    const menuScreen = document.getElementById("menuScreen");
    const startButton = document.getElementById("startButton");

    let assetsLoaded = 0;
    const totalAssets = 5;

    function updateLoadingProgress() {
      assetsLoaded++;
      const percent = Math.floor((assetsLoaded / totalAssets) * 100);
      loadingScreen.textContent = `Loading... ${percent}%`;
      if (assetsLoaded === totalAssets) {
        setTimeout(() => {
          loadingScreen.style.display = "none";
          menuScreen.style.display = "flex";
        }, 500);
      }
    }

    const bucketImg = new Image();
    bucketImg.src = "https://i.ibb.co/zfyzF3J/bucket.png";
    bucketImg.onload = updateLoadingProgress;

    const coinImg = new Image();
    coinImg.src = "https://i.ibb.co/1M6mY2m/coin.png";
    coinImg.onload = updateLoadingProgress;

    const bombImg = new Image();
    bombImg.src = "https://i.ibb.co/Nt0Yk1n/bomb.png";
    bombImg.onload = updateLoadingProgress;

    const bgImg = new Image();
    bgImg.src = "https://i.ibb.co/YQ0h6sJ/background.png";
    bgImg.onload = updateLoadingProgress;

    const powerUpImg = new Image();
    powerUpImg.src = "https://i.ibb.co/S0KxKQv/powerup.png";
    powerUpImg.onload = updateLoadingProgress;

    const sounds = {
      coin: new Audio("https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg"),
      bomb: new Audio("https://actions.google.com/sounds/v1/alarms/beep_short.ogg"),
      power: new Audio("https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg"),
    };

    function playSound(sound) {
      sound.currentTime = 0;
      sound.play();
    }

    const bucket = {
      x: canvas.width / 2 - 50,
      y: canvas.height - 120,
      width: 100,
      height: 100,
      dx: 0,
    };

    let objects = [];
    let score = 0;
    let lives = 3;
    let gameOver = false;

    function spawnObject() {
      const type = Math.random() < 0.7 ? "coin" : Math.random() < 0.85 ? "bomb" : "powerup";
      const img = type === "coin" ? coinImg : type === "bomb" ? bombImg : powerUpImg;
      objects.push({
        x: Math.random() * (canvas.width - 50),
        y: -50,
        width: 50,
        height: 50,
        type,
        img
      });
    }

    function resetGame() {
      objects = [];
      score = 0;
      lives = 3;
      gameOver = false;
      bucket.x = canvas.width / 2 - 50;
    }

    function update() {
      if (gameOver) return;

      bucket.x += bucket.dx;
      if (bucket.x < 0) bucket.x = 0;
      if (bucket.x + bucket.width > canvas.width) bucket.x = canvas.width - bucket.width;

      if (Math.random() < 0.02) spawnObject();

      for (let i = objects.length - 1; i >= 0; i--) {
        const obj = objects[i];
        obj.y += 5;
        if (
          obj.y + obj.height > bucket.y &&
          obj.x < bucket.x + bucket.width &&
          obj.x + obj.width > bucket.x
        ) {
          if (obj.type === "coin") {
            score += 10;
            playSound(sounds.coin);
          } else if (obj.type === "bomb") {
            lives -= 1;
            playSound(sounds.bomb);
            if (lives <= 0) {
              gameOver = true;
            }
          } else if (obj.type === "powerup") {
            score += 50;
            playSound(sounds.power);
          }
          objects.splice(i, 1);
        } else if (obj.y > canvas.height) {
          objects.splice(i, 1);
        }
      }
    }

    function draw() {
      ctx.drawImage(bgImg, 0, 0, canvas.width, canvas.height);

      ctx.drawImage(bucketImg, bucket.x, bucket.y, bucket.width, bucket.height);

      objects.forEach(obj => {
        ctx.drawImage(obj.img, obj.x, obj.y, obj.width, obj.height);
      });

      ctx.fillStyle = "black";
      ctx.font = "24px Arial";
      ctx.fillText(`Score: ${score}`, 20, 40);
      ctx.fillText(`Lives: ${lives}`, 20, 70);

      if (gameOver) {
        ctx.fillStyle = "rgba(0,0,0,0.7)";
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = "white";
        ctx.font = "48px Arial";
        ctx.fillText("Game Over", canvas.width / 2 - 120, canvas.height / 2);
      }
    }

    function loop() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      update();
      draw();
      requestAnimationFrame(loop);
    }

    window.addEventListener("keydown", (e) => {
      if (e.key === "ArrowLeft") bucket.dx = -7;
      else if (e.key === "ArrowRight") bucket.dx = 7;
    });

    window.addEventListener("keyup", (e) => {
      if (e.key === "ArrowLeft" || e.key === "ArrowRight") bucket.dx = 0;
    });

    let touchStartX = null;
    canvas.addEventListener("touchstart", (e) => {
      touchStartX = e.touches[0].clientX;
    });

    canvas.addEventListener("touchmove", (e) => {
      if (touchStartX !== null) {
        let touchX = e.touches[0].clientX;
        let deltaX = touchX - touchStartX;
        bucket.x += deltaX;
        touchStartX = touchX;
      }
    });

    startButton.addEventListener("click", () => {
      menuScreen.style.display = "none";
      resetGame();
      loop();
    });
  </script>
</body>
</html>
